pacf(total.l.d, lag.max = 50)
Model1 <- sarima(total.l, 0,1,12) ## BEST
Model3 <- sarima(total.l, 12,1,0)
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d, lag.max = 50)
pacf(total.l.d, lag.max = 50)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
View(Model1)
Model1$ttable
Model3 <- sarima(total.l, 12,1,0)
View(Model3)
Model3$ttable
Model4 <- sarima(total.l, 11,1,0)
Model4$ttable
Model4 <- sarima(total.l, 11,1,0)
Model4$ttable
Model3 <- sarima(total.l, 11,1,1)
Model3$ttable
View(Model1)
Model1[["ttable"]]
rm(Model1)
rm(Model3)
rm(Model4)
rm(Model5)
Model1 <- sarima(total.l, 0,1,12) #
Model1 <- sarima(total.l, 0,1,12)
total.c <-  total
total.l <- log(total.c)
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
Model1 <- arima(total.l, 0,1,12)
Model1 <- sarima(total.l, 0,1,12)
View(Model1)
Model1[["ttable"]]
Model2 <- sarima(total.l, 11,1,1)
View(Model2)
Model2[["ttable"]]
Model2 <- sarima(total.l, 11,1,0)
Model2$ttable
?Sarima
?sarima
View(Model1)
Model3 <- sarima(3,1,3)
Model3 <- sarima(total.l, 3,1,3)
Model3 <- sarima(total.l, 4,1,3)
Model3 <- sarima(total.l, 8,1,3)
Model3 <- sarima(total.l, 10,1,2)
Model3 <- sarima(total.l, 6,1,4)
Model3 <- sarima(total.l, 10,1,1)
Model3 <- sarima(total.l, 10,1,0)
Model3 <- sarima(total.l, 9,1,3)
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 100)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
Model3 <- sarima(total.l, 12,1,12)
Model3 <- sarima(total.l, 11,1,12)
Model3$ttable
Model3 <- sarima(total.l, 11,1,11)
Model3$ttable
Model3 <- sarima(total.l, 12,1,11)
Model3 <- sarima(total.l, 11,1,12)
View(Model3)
View(Model2)
View(Model1)
View(Model2)
View(Model2)
View(Model3)
sarima.for(total.l, 10)
sarima.for(total.l, 0,1,12)
?sarima.for
sarima.for(total.l,10, 0,1,12)
Model1$ttable
Model2 <- sarima(total.l, 12,1,0)
View(Model2)
View(Model1)
View(Model2)
View(Model1)
Model2$ttable
Model3 <- sarima(total.l, 11,1,0)
View(Model3)
View(Model1)
View(Model3)
Model3$ttable
Model4 <- sarima(total.l, 11,1,8)
Model4 <- sarima(total.l, 11,1,6)
Model4$ttable
Model4 <- sarima(total.l, 11,1,5)
Model4$ttable
Model4 <- sarima(total.l, 10,1,5)
Model4$ttable
Model4 <- sarima(total.l, 9,1,5)
Model4$ttable
Model4 <- sarima(total.l, 9,1,6)
View(Model1)
Model4 <- sarima(total.l, 3,1,3)
Model4 <- sarima(total.l, 4,1,3)
Model4$ttable
Model4 <- sarima(total.l, 7,1,4)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
Model4 <- sarima(total.l, 8,1,2)
View(Model4)
View(Model1)
View(Model4)
Model4$ttable
Model4 <- sarima(total.l, 7,1,2)
View(Model4)
View(Model1)
View(Model4)
Model4$ttable
Model4 <- sarima(total.l, 7,1,3)
Model4 <- sarima(total.l, 7,1,2)
Model4$ttable
Model4 <- sarima(total.l, 8,1,2)
View(Model4)
Model4$ttable
Model5 <- sarima(total.l, 8,1,3)
Model5 <- sarima(total.l, 8,1,4)
Model5 <- sarima(total.l, 8,1,5)
View(Model5)
View(Model1)
View(Model5)
Model5$ttable
Model5 <- sarima(total.l, 7,1,5)
Model5$ttable
Model5 <- sarima(total.l, 6,1,5)
Model5$ttable
Model5 <- sarima(total.l, 6,1,6)
Model4 <- sarima(total.l, 8,1,2)
Model4$ttable
Model5 <- sarima(total.l, 8,1,3)
total.c <-  window(total, end = 2020)
total.l <- log(total.c) # log total
total.l.d <- diff(total.l, 1) # difference log total
total.l.d.s <- diff(total.l.d, 12)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
Model1 <- sarima(total.l, 0,1,12)
Model2 <- sarima(total.l, 12,1,0)
Model1$ttable
Model1$ttable
Model2$ttable
Model3 <- sarima(total.l, 11,1,0)
Model3$ttable
Model4 <- sarima(total.l, 11,1,1)
Model4 <- sarima(total.l, 11,1,1)
Model4$ttable
total.l <- log(total.c) # log total
total.l.d <- diff(total.l, 1) # difference log total
total.l.d.s <- diff(total.l.d, 12) # difference log total seasonal
Model1 <- sarima(total.l, 0,1,12)
Model2 <- sarima(total.l, 12,1,0)
Model3 <- sarima(total.l, 11,1,0)
Model5$ttable
Model6 <- sarima(total.l, 4,1,4)
Model5 <- sarima(total.l, 11,1,2)
Model5$ttable
Model6 <- sarima(total.l, 11,1,3)
Model6$ttable
View(Model6)
View(Model1)
View(Model6)
View(Model5)
View(Model1)
View(Model3)
View(Model4)
Model6$ttable
View(Model5)
View(Model5)
View(Model2)
View(Model1)
Model5$ttable
Model6 <- sarima(total.l, 12,1,2)
View(Model6)
View(Model1)
Model6$ttable
Model7 <-sarima(total.l, 12, 1, 1)
View(Model5)
Model7$ttable
View(Model7)
View(Model1)
View(Model7)
View(Model1)
Model8 <-sarima(total.l, 13,1,1)
View(Model8)
View(Model7)
View(Model7)
View(Model7)
View(Model8)
View(Model7)
Model8$ttable
Model8 <- sarima(total.l, 3,1,3)
Model8$ttable
Model8 <- sarima(total.l, 6,1,3)
Model8$ttable
Model8 <- sarima(total.l, 6,1,2)
Model8$ttable
Model8 <- sarima(total.l, 7,1,2)
View(Model8)
View(Model1)
Model8$ttable
Model8 <- sarima(total.l, 6,1,2)
Model8$ttable
Model8 <- sarima(total.l, 6,1,2)
Model8$ttable
Model8 <- sarima(total.l, 6,1,2)
Model8$ttable
Model8 <- sarima(total.l, 7,1,3)
Model8$ttable
Model8 <- sarima(total.l, 1,1,1)
Model8 <- sarima(total.l, 1,1,1)
Model8$ttable
Model8 <- sarima(total.l, 1,1,0)
Model9 <- sarima(total.l,2,1,0)
Model8$ttable
Model9$ttable
Model9 <- sarima(total.l,5,1,0)
Model9$ttable
Model9 <- sarima(total.l,4,1,0)
Model9 <- sarima(total.l,4,1,1)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
Model9 <- sarima(total.l,0,1,2)
Model9 <- sarima(total.l,0,1,3)
Model9 <- sarima(total.l,1,1,3)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
Model9 <- sarima(total.l,9,1,2)
View(Model9)
View(Model3)
View(Model1)
View(Model9)
View(Model6)
View(Model1)
View(Model2)
View(Model3)
View(Model4)
View(Model5)
View(Model6)
View(Model7)
View(Model6)
View(Model7)
View(Model8)
View(Model9)
Model9 <- sarima(total.l,9,1,2)
Model9$ttable
Model9 <- sarima(total.l,8,1,2)
Model9 <- sarima(total.l,9,1,2)
Model9 <- sarima(total.l,9,1,3)
Model9$ttable
Model9 <- sarima(total.l,9,1,2)
Model9$ttable
Model9 <- sarima(total.l,8,1,2)
Model9$ttable
Model9 <- sarima(total.l,8,1,1)
Model9$ttable
Model10 <-sarima(total.l, 9,1,1)
Model10$ttable
Model11 <-sarima(total.l,9,1,2)
Model11$ttable
Model12 <-sarima(total.l, 8,1,2)
Model12$ttable
Model9 <- sarima(total.l,8,1,1)
Model9$ttable
Model12 <-sarima(total.l, 7,1,1)
Model12$ttable
Model12 <-sarima(total.l, 6,1,1)
Model12$ttable
Model12 <-sarima(total.l, 5,1,1)
Model12$ttable
Model12 <-sarima(total.l, 4,1,1)
Model12 <-sarima(total.l, 4,1,1)
Model12$ttable
Model12 <-sarima(total.l, 3,1,1)
Model12 <-sarima(total.l, 3,1,1)
Model12$ttable
Model12 <-sarima(total.l, 2,1,1)
Model12$ttable
Model12 <-sarima(total.l, 2,1,0)
Model12$ttable
Model12 <-sarima(total.l, 1,1,0)
Model12 <-sarima(total.l, 0,1,0)
Model12 <-sarima(total.l, 1,1,0)
Model12 <-sarima(total.l, 1,1,7)
View(Model7)
View(Model8)
View(Model7)
View(Model6)
View(Model7)
View(Model6)
View(Model1)
?sarima.for()
sarima.for(total.l, 36, 0,1,12)
library(forecast)
?forecast
fr <- forecast(Model7, 10, total.l)
fr <- forecast(Model7, h = 10)
ym <- Model7(total.l)
fr <- forecast(Model7, h = 10)
par(mfrow =c(1,3))
sarima.for(total.l, 36, 0,1,12)
sarima.for(total.l, 36, 12,1,2)
sarima.for(total.l, 36, 0,1,12)
## Forecasting
par(mfrow =c(1,3))
sarima.for(total.l, 36, 0,1,12, main = "ALLAH")
sarima.for(total.l, 36, 12,1,2)
sarima.for(total.l, 36, 0,1,12)
## Forecasting
par(mfrow =c(1,3))
sarima.for(total.l, 36, 0,1,12, main = "Arima(12,1,1)")
sarima.for(total.l, 36, 12,1,2, main = "Arima(12,1,2)")
sarima.for(total.l, 36, 0,1,12), main = "Arima(0,1,12)")
par(mfrow =c(1,3))
sarima.for(total.l, 36, 0,1,12, main = "Arima(12,1,1)")
sarima.for(total.l, 36, 12,1,2, main = "Arima(12,1,2)")
sarima.for(total.l, 36, 0,1,12, main = "Arima(0,1,12)")
Model8 <- sarima(total.l, 1,1,12)
Model9 <- sarima(total.l,2, 1,12)
View(Model8)
View(Model9)
View(Model8)
View(Model7)
Model9$ttable
Model8$ttable
Model1$ttable
Model10 <sarima(total.l, 0,1,13)
View(Model10)
Model10 <sarima(total.l, 0,2,12)
Model10 <sarima(total.l, 12,2,1)
View(Model10)
Model10$ttable
Model10 <sarima(total.l, 12,2,1)
total.l.d2 <- diff(total.l, 2)
tsplot(total.l.d2)
par(mfrow=c(1,2))
tsplot(total.l.d2)
acf2(total.l.d2)
Model10 <-sarima(total.l.d2, 12,2,2)
Model10$ttable
Model10 <-sarima(total.l.d2, 11,2,2)
Model11<-sarima(total.l.d2, 12,2,1)
Model11<-sarima(total.l.d2, 12,2,0)
Model11$ttable
par(mfrow=c(1,2))
tsplot(total.l.d2)
acf2(total.l.d2)
Model11<-sarima(total.l.d2, 12,2,12)
Model11<-sarima(total.l.d2, 13,2,12)
View(Model11)
par(mfrow=c(1,2))
tsplot(total.l.d2)
acf2(total.l.d2)
Model11<-sarima(total.l.d2, 1,2,1)
Model11<-sarima(total.l.d2, 2,2,1)
Model11<-sarima(total.l.d2, 2,2,2)
?Box.test
Model7 <-sarima(total.l, 12, 1, 1)
Box.test(resid(Model7),type="Ljung",lag=20,fitdf=1)
View(Model7)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung", lag = 20)
test <- Box.test(Model7[["fit"]][["residuals"]], type = "Ljung", lag = 20)
View(test)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung", lag = 1)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung", lag = 2)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung", lag = 3)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung", lag = 14)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung", lag = 16)
View(Model7)
View(Model7)
Model7[["fit"]][["model"]][["a"]]
?sarima
Model7[["fit"]][["model"]][["Pn"]]
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 16)
Box.Ljung
install.packages("FitAR")
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 14)
Model7 <-sarima(total.l, 12, 1, 1)
library(astsa)
library(ggplot2)
library(timeSeries)
library(forecast)
Model7 <-sarima(total.l, 12, 1, 1)
Model6 <- sarima(total.l, 12,1,2)
?Box.test
Box.test(Model7[["fit"]][["residuals"]], lag = 20, fitdf = 562)
Model7 <-sarima(total.l, 12, 1, 1)
Box.test(Model7[["fit"]][["residuals"]], lag = 20, fitdf = 562)
Box.test(Model7[["fit"]][["residuals"]], lag = 20, fitdf = 577)
Box.test(Model7[["fit"]][["residuals"]], lag = 20, fitdf = 0)
Box.test(Model7[["fit"]][["residuals"]], lag = 20, fitdf = 1)
Box.test(Model7[["fit"]][["residuals"]], lag = 20, fitdf = 562)
Box.test(Model7[["fit"]][["residuals"]], lag = 20, fitdf = 20)
Box.test(Model7[["fit"]][["residuals"]], lag = 20, fitdf = 6)
Box.test(Model7[["fit"]][["residuals"]], lag = 20, fitdf = 15)
Model7[["fit"]][["residuals"]]
Model7 <-sarima(total.l, 12, 1, 1)
library(astsa)
library(ggplot2)
library(timeSeries)
library(forecast)
Model7 <-sarima(total.l, 12, 1, 1)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 14, fitdf = 1)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 14, fitdf = 563)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 14, fitdf = 9)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 14, fitdf = 15)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 14, fitdf = 13)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 15, fitdf = 13)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 16, fitdf = 13)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 18, fitdf = 13)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 21, fitdf = 13)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 22, fitdf = 13)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 30, fitdf = 13)
Box.test(Model7[["fit"]][["residuals"]], type = "Ljung-Box", lag = 16, fitdf = 13)
auto.arima(total.l, 1)
Models <- sarima(total.l, 1,1,0,0,0,1,12)
View(Models)
View(Model7)
View(Models)
Models <- sarima(total.l, 1,1,0,0,1,1,12)
Models <- sarima(total.l, 1,1,1,0,1,1,12)
Models <- sarima(total.l, 0,1,2,0,1,1,12)
Models <- sarima(total.l, 1,1,2,0,1,1,12)
Models <- sarima(total.l, 0,0,1,1,1,1,12)
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
Model7 <-sarima(total.l, 12, 1, 1)
library(glmnet)
?cv.glmnet
##############
# Use the following code to generate index for your assignment #1
# Put it at the "begining" of your code before everything else
##############
set.seed(0)
# load data
library(MTPS)
data(HIV)
nn=nrow(XX)
#stratify records according to drug ABC resistance
brks = quantile(YY[,"ABC"], probs = seq(0.1, 0.9, 0.1))
grps = cut(YY[,"ABC"], breaks=c(-Inf,brks,Inf))
#generate index matrix for 50 experiments
nexperiment = 50
idxMat=matrix(nrow=nn, ncol=nexperiment)
for(jj in 1:nexperiment)
{
idx4 = rep(NA,nn)
for(ii in levels(grps))
{
idxtmp = (1:nn)[grps==ii]
idx4[grps==ii] <- sample(c(F,T),size=length(idxtmp), replace = T, prob=c(0.8,0.2))
View(YY)
View(YY)
View(XX)
View(idxMat)
s
s
s
ss
quit()
##############
# Use the following code to generate index for your assignment #1
# Put it at the "begining" of your code before everything else
##############
set.seed(0)
# load data
library(MTPS)
data(HIV)
nn=nrow(XX)
#stratify records according to drug ABC resistance
brks = quantile(YY[,"ABC"], probs = seq(0.1, 0.9, 0.1))
grps = cut(YY[,"ABC"], breaks=c(-Inf,brks,Inf))
#generate index matrix for 50 experiments
nexperiment = 50
idxMat=matrix(nrow=nn, ncol=nexperiment)
for(jj in 1:nexperiment)
{
idx4 = rep(NA,nn)
for(ii in levels(grps))
{
idxtmp = (1:nn)[grps==ii]
idx4[grps==ii] <- sample(c(F,T),size=length(idxtmp), replace = T, prob=c(0.8,0.2))
}
idxMat[,jj] = idx4
}
