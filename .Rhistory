library(astsa)
library(ggplot2)
library(timeSeries)
setwd("/Users/dario/Desktop/TSP") # Set your working directory
library(astsa)
library(ggplot2)
library(timeSeries)
# col, name, detail
# 2, BCPI,	 BCPI Total
# 3, BCNE,	 BCPI Excluding Energy
# 4, ENER,	 BCPI Energy
# 5, MTLS,	 BCPI Metals and Minerals
# 6, FOPR,	 BCPI Forestry
# 7, AGRI,	 BCPI Agriculture
# 8, FISH,	 BCPI Fish
## A.____ = annual metric; M.____ = monthly metric
## 1972-01-01 - 2023-10-01 ##
M.BCPI <- as.data.frame(read.csv("M.BCPI.csv"))
M.ER <- as.data.frame(read.csv("ER.csv"))
M.BCPI <- as.data.frame(read.csv("M.BCPI.csv"))
View(M.BCPI)
total <- ts(M.BCPI[,2], start = 1972, frequency = 12)
tsplot(total)
price <- window(total, start = 1996)
tsplot(price)
price.tran <- diff((log(y)), 1)
price.tran <- diff((log(y)), 1)
price.tran <- diff((log(price)), 1)
par(mfrow = c(1,3))
tsplot(price.tran, ylab = "BCPI", main = "BCPI 1996-2023")
acf(price.tran)
pacf(price.tran)
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
# Look at log transformation
price.log <- log(price)
tsplot(price.log, main = "Log Price of Index")
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
lines(pirce.log, col = "red")
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
line(pirce.log, col = "red")
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
line(pirce.log)
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
price.log <- log(price)
line(pirce.log)
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
line(price.log, col = "red")
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
line(price.log)
# Look at log transformation
price.log <- log(price)
tsplot(price.log, main = "Log Price of Index")
getwd()
# Need to find transformation for stationary distribution
price.tran <- diff((price), 1)
par(mfrow = c(1,3))
tsplot(price.tran, ylab = "BCPI", main = "BCPI 1996-2023")
acf(price.tran)
pacf(price.tran)
# Need to find transformation for stationary distribution
price.tran <- diff((price.log), 1)
par(mfrow = c(1,3))
tsplot(price.tran, ylab = "BCPI", main = "BCPI 1996-2023")
acf(price.tran)
pacf(price.tran)
# Need to find transformation for stationary distribution
price.tran <- diff((price), 1)
par(mfrow = c(1,3))
tsplot(price.tran, ylab = "BCPI", main = "BCPI 1996-2023")
acf(price.tran)
pacf(price.tran)
Model2 <- arima(price.log,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model2 <- sarima(price.log,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model3 <-sarima(price.log,0,1,2,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model4 <- sarima(price.log,0,1,3,details = TRUE, no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model5 <-sarima(price.log,1,1,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model6<- sarima(price.log,1,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model7<- sarima(price.log,2,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
AICr1 <- c(Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC,Model7$AIC)
?which.min
rm(Model7)
Model1 <- sarima(price.log,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model2 <-sarima(price.log,0,1,2,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model3 <- sarima(price.log,0,1,3,details = TRUE, no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model4 <-sarima(price.log,1,1,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model5<- sarima(price.log,1,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model6<- sarima(price.log,2,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
AICr1 <- c(Model1$AIC,Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC)
best <- which.min(AICr1)
best
AICr1
Model1 <- sarima(price.log,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model1 <- sarima(price.log,0,2,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model2 <-sarima(price.log,0,2,2,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model3 <- sarima(price.log,0,2,3,details = TRUE, no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model4 <-sarima(price.log,1,2,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model5<- sarima(price.log,1,2,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model6<- sarima(price.log,2,2,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
AICr1 <- c(Model1$AIC,Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC)
best2 <- which.min(AICr1)
Model4 <-sarima(price.log,1,2,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
?window
price
price
price.log.cov = window(price.log, end = 2019)
tail(price.log.cov)
View(M.BCPI)
price.log.cov = window(price.log, end = 2019-02-01)
price.log.cov = window(price.log, end = 2019)
price.log.cov = window(price.log, end = 2019)
Model1 <- sarima(price.log.cov,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model2 <-sarima(price.log.cov,0,1,2,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model3 <- sarima(price.log.cov,0,1,3,details = TRUE, no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model4 <-sarima(price.log.cov,1,1,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model5<- sarima(price.log.cov,1,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model6<- sarima(price.log.cov,2,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
AICr1 <- c(Model1$AIC,Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC)
best <- which.min(AICr1)
AICr1 <- c(Model1$AIC,Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC)
AICr1
Model4 <-sarima(price.log.cov,1,1,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
View(Model4)
price.log.cov
price.log.cov = window(price.log, end = 2020)
price.log.cov = window(price.log, end = 2020)
price.log.cov
Model1 <- sarima(price.log.cov,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model2 <-sarima(price.log.cov,0,1,2,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model3 <- sarima(price.log.cov,0,1,3,details = TRUE, no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model4 <-sarima(price.log.cov,1,1,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model5<- sarima(price.log.cov,1,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model6<- sarima(price.log.cov,2,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
AICr1 <- c(Model1$AIC,Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC)
# best model
best <- which.min(AICr1) # model 4 is the best
M.BCPI <- as.data.frame(read.csv("M.BCPI.csv"))
library(astsa)
library(ggplot2)
library(timeSeries)
BCPI = 2
BCNE = 3
ENER = 4
MTLS = 5
FOPR = 6
AGRI = 7
FISH = 8
total <- ts(M.BCPI[,2], start = 1972, frequency = 12)
tsplot(total)
plot_everything<- function(diff = d, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1972, end = 2020, frequency = 12)
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
par(mfrow=c(row,1))
tsplot(data,
main = paste(names(M.BCPI[i])), ylab = "Index" )
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
plot_everything<- function(diff = d, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
View(plot_everything)
View(plot_everything)
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1972, end = 2020, frequency = 12)
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
par(mfrow=c(row,1))
tsplot(data,
main = paste(names(M.BCPI[i])), ylab = "Index" )
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
#Plots every commodity on separate pages
plot_everything<- function(diff = d, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
plot_everything<- function(diff = d, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
}
plot_everything<- function(diff = d, log = FALSE, acf = TRUE, pacf = TRUE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
View(mult_plot)
price <- window(total, start = 1996)
tsplot(price, main = "Total Index")
tsplot(pirce.log.cov)
price.log.cov = window(price.log, end = 2020)
price.log <- log(price)
price.log.cov = window(price.log, end = 2020)
tsplot(price.log.cov)
plot_everything(1, TRUE)
plot_everything(1, TRUE)
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1996, end = 2020, frequency = 12)
par(mfrow=c(row,1))
tsplot(data, main = paste(names(M.BCPI[i])), ylab = "Index" )
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
plot_everything(1, TRUE)
par(mfrow=c(1.3))
par(mfrow=c(1,3))
plot_everything(1, TRUE)
plot_everything(1, TRUE, FALSE, FALSE)
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1996, end = 2020, frequency = 12)
par(mfrow=c(row,1))
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
tsplot(data, main = paste(names(M.BCPI[i])), ylab = "Index" )
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
plot_everything<- function(diff = 1, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
plot_everything(1, TRUE)
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1980, end = 2020, frequency = 12)
par(mfrow=c(row,1))
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
tsplot(data, main = paste(names(M.BCPI[i])), ylab = "Index" )
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
#Plots every commodity on separate pages
plot_everything<- function(diff = 1, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1980, end = 2020, frequency = 12)
par(mfrow=c(row,1))
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
tsplot(data, main = paste(names(M.BCPI[i])), ylab = "Index" )
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
#Plots every commodity on separate pages
plot_everything<- function(diff = 1, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
plot_everything(1, TRUE)
plot_everything(1)
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
M.BCPI <- as.data.frame(read.csv("M.BCPI.csv"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
source("~/Desktop/Time-Series/Time-Series-Project/TimeSeriesFinal.R", echo=TRUE)
