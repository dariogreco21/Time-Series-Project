if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
par(mfrow=c(row,1))
tsplot(data,
main = paste(names(M.BCPI[i])), ylab = "Index" )
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
plot_everything<- function(diff = d, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
View(plot_everything)
View(plot_everything)
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1972, end = 2020, frequency = 12)
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
par(mfrow=c(row,1))
tsplot(data,
main = paste(names(M.BCPI[i])), ylab = "Index" )
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
#Plots every commodity on separate pages
plot_everything<- function(diff = d, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
plot_everything<- function(diff = d, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
}
plot_everything<- function(diff = d, log = FALSE, acf = TRUE, pacf = TRUE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
View(mult_plot)
price <- window(total, start = 1996)
tsplot(price, main = "Total Index")
tsplot(pirce.log.cov)
price.log.cov = window(price.log, end = 2020)
price.log <- log(price)
price.log.cov = window(price.log, end = 2020)
tsplot(price.log.cov)
plot_everything(1, TRUE)
plot_everything(1, TRUE)
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1996, end = 2020, frequency = 12)
par(mfrow=c(row,1))
tsplot(data, main = paste(names(M.BCPI[i])), ylab = "Index" )
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
plot_everything(1, TRUE)
par(mfrow=c(1.3))
par(mfrow=c(1,3))
plot_everything(1, TRUE)
plot_everything(1, TRUE, FALSE, FALSE)
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1996, end = 2020, frequency = 12)
par(mfrow=c(row,1))
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
tsplot(data, main = paste(names(M.BCPI[i])), ylab = "Index" )
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
plot_everything<- function(diff = 1, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
plot_everything(1, TRUE)
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1980, end = 2020, frequency = 12)
par(mfrow=c(row,1))
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
tsplot(data, main = paste(names(M.BCPI[i])), ylab = "Index" )
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
#Plots every commodity on separate pages
plot_everything<- function(diff = 1, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
mult_plot <- function(i, DIFF = d, log = FALSE, ACF = FALSE, PACF = FALSE){
row = 1
data <- ts(M.BCPI[,i], start = 1980, end = 2020, frequency = 12)
par(mfrow=c(row,1))
if(log == TRUE){
data <- log(data)
}
if(!missing(DIFF) & DIFF>0){
data <- diff(data, DIFF)
}
if(ACF == TRUE){#bad coder moment
row = row + 1
}
if(PACF == TRUE){
row = row + 1
}
tsplot(data, main = paste(names(M.BCPI[i])), ylab = "Index" )
if(ACF == TRUE){
acf(data, 48)
}
if(PACF == TRUE){
pacf(data, 48)
}
}
#Plots every commodity on separate pages
plot_everything<- function(diff = 1, log = FALSE, acf = FALSE, pacf = FALSE){
for(i in 2:8){
mult_plot(i, diff, log, acf, pacf)
}
}
plot_everything(1, TRUE)
plot_everything(1)
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
M.BCPI <- as.data.frame(read.csv("M.BCPI.csv"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
A.BCPI <- as.data.frame(read.csv("A.BCPI.cvs"))
source("~/Desktop/Time-Series/Time-Series-Project/TimeSeriesFinal.R", echo=TRUE)
M.BCPI <- as.data.frame(read.csv("M.BCPI.csv"))
library(astsa)
library(ggplot2)
library(timeSeries)
library(forecast)
total <- ts(M.BCPI[,3], start = 1972, frequency = 12)
total <-  window(total, end = 2020) # CHANGE TOTAL
total.l <- log(total) # log total
total.l.d <- diff(total.l, 1)
total.l.d.s <- diff(total.l.d, 12)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(ltotal.d)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.d.l)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d, lag.max = 50)
pacf(total.l.d, lag.max = 50)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(ltotal.ds)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
Model4 <- sarima(total.l, 0,1,1, P =0, D =1, Q = 1, S = 12)
View(Model4)
Model1 <- sarima(total.l, 1,1,0, P = 1, D = 1, Q = 1, S = 12)
View(Model1)
View(Model4)
View(Model1)
View(Model4)
View(Model1)
View(Model4)
View(Model1)
View(Model4)
View(Model1)
View(Model4)
View(Model1)
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
Model3 <- sarima(total.l, 1,1,1, P =0, D =1, Q = 1, S = 12)
View(Model3)
View(Model1)
View(Model3)
View(Model1)
View(Model3)
View(Model1)
View(Model3)
Model1 <- sarima(total.l, 1,1,0, P = 1, D = 1, Q = 1, S = 12)
Model3 <- sarima(total.l, 1,1,1, P =0, D =1, Q = 1, S = 12)
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
sarima.for(ltotal,12,  1, 1, 1, 0, 1, 1, 12)
sarima.for(total.l,12, 1, 1, 1, 0, 1, 1, 12)
# Forecast
sarima.for(total.l,36, 1, 1, 1, 0, 1, 1, 12)
tsplot(log(BCPI[,3]))
tsplot(log(M.BCPI[,3]))
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
Model5 <- sarima(total.l, 2,1,1, P = 0, D = 1, Q = 1, S = 12)
View(Model5)
View(Model3)
Model5 <- sarima(total.l, 2,1,2, P = 0, D = 1, Q = 1, S = 12)
View(Model5)
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
Model5 <- sarima(total.l, 0,1,2, P = 0, D = 1, Q = 1, S = 12)
View(Model5)
View(Model3)
Model1 <- sarima(total.l, 1,1,0, P = 0, D = 1, Q = 1, S = 12)
View(Model1)
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
View(Model3)
View(Model1)
View(Model3)
View(Model1)
View(Model3)
View(Model1)
total <- ts(M.BCPI[,3], start = 1972, frequency = 12)
total.c <-  window(total, end = 2020) # CHANGE TOTAL
total.l <- log(total.c) # log total
total.l.d <- diff(total.l, 1)
total.l.d.s <- diff(total.l.d, 12)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d, lag.max = 50)
pacf(total.l.d, lag.max = 50)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
Model1 <- sarima(total.l, 1,1,0, P = 0, D = 1, Q = 1, S = 12) ## BEST
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d, lag.max = 50)
pacf(total.l.d, lag.max = 50)
sarima.for(total.l, 36, Model1 )
sarima.for(total.l, 36, 1,1,0,0,1,1,12)
?sarima.for
sarima.for(total.l, 36, 1,1,0,0,1,1,12, type = "l")
sarima.for(total.l, 36, 1,1,0,0,1,1,12, type = l)
sarima.for(total.l, 36, 1,1,0,0,1,1,12)
sarima.for(total.l, 36, 1,1,0,0,1,1,12)
fr <- sarima.for(total.l, 36, 1,1,0,0,1,1,12)
View(fr)
?window
act <- window(total.l, start = 2011, end = 2013)
?sarima.for()
act <- window(total.l, start = c(2011,1,3), end = 2013)
act <- window(total.l, start = c(2011,3,1), end = 2013)
total.l
act <- window(total.l, start = c(2011,"Mar"), end = 2013)
View(M.BCPI)
act  <- subset(M.BCPI[,3], Date == as.Date("2023-03-01"))
act  <- subset(M.BCPI[,3], Date == as.Date("2011-03-01"))
fr <- sarima.for(total.l, 36, 1,1,0,0,1,1,12)
act  <- M.BCPI[471:613,3]
act  <- log(M.BCPI[471:613,3])
View(Model4)
act  <- log(M.BCPI[468:604,3])
plot(act)
plot(act, type = "b")
plot(act, type = "l")
par(mfrow = c(1,2))
fr <- sarima.for(total.l, 36, 1,1,0,0,1,1,12)
act  <- log(M.BCPI[468:604,3])
plot(act, type = "l")
## FORECASTING
par(mfrow = c(1,2))
fr <- sarima.for(total.l, 36, 1,1,0,0,1,1,12)
act  <- log(M.BCPI[473:604,3])
plot(act, type = "l")
fr <- sarima.for(total.l, 36, 1,1,0,0,1,1,12, plot.all = TRUE)
fr <- sarima.for(total.l, 36, 1,1,0,0,1,1,12, plot.all = TRUE, type = typel)
fr <- forecast(Model1, h = 36)
?predict
View(fr)
fr <- sarima.for(total.l, 36, 1,1,0,0,1,1,12)
fr[["pred"]]
?sarima.for
library(astsa)
library(ggplot2)
library(timeSeries)
library(forecast)
fr <- sarima.for(total.l, 36, 1,1,0,0,1,1,12)
View(fr)
fr <- sarima.for(total.l, 36, 1,1,0,0,1,1,12)$pred
tsplot(total.l)
plot(t, c(prev,fr))
fr <- sarima.for(total.l, 36, 1,1,0,0,1,1,12)$pred
prev <- as.vector(total.l)
t <- time(total)
plot(t, c(prev,fr))
len(t)
length(t)
length(c(prev, fr))
fr <- sarima.for(total.l, 45, 1,1,0,0,1,1,12)$pred
prev <- as.vector(total.l)
t <- time(total)
plot(t, c(prev,fr))
tsplot(total)
tsplot(total)
lines(fr, col = 'red')
tsplot(log(total))
lines(fr, col = 'red')
total.l.d.s <- diff(total.l.d, 72) # difference log total seasonal
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
library(astsa)
library(ggplot2)
library(timeSeries)
library(forecast)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
total.l.d.s <- diff(total.l.d, 36)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
Model4 <- sarima(total.l, 0,1,1, P =0, D =1, Q = 3, S = 36)
Model5 <- sarima(total.l, 0,1,2, P = 0, D = 1, Q = 1, S = 36)
View(Model1)
View(Model4)
View(Model5)
View(Model4)
View(Model1)
total.l.d.s <- diff(total.l.d, 24) #
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
Model5 <- sarima(total.l, 0,1,2, P = 2, D = 1, Q = 1, S = 24)
View(Model5)
View(Model1)
total.l.d.s <- diff(total.l.d, 48) # difference log total seasonal
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
library(astsa)
library(ggplot2)
library(timeSeries)
library(forecast)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 100)
pacf(total.l.d.s, lag.max = 100)
library(astsa)
library(ggplot2)
library(timeSeries)
library(forecast)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
total.l.d.s <- diff(total.l.d, 36)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
Model5 <- sarima(total.l, 0,1,3, P = 3, D = 1, Q = 0, S = 36)
View(Model5)
View(Model1)
View(Model5)
View(Model1)
View(Model5)
View(Model1)
View(Model5)
View(Model5)
View(Model1)
View(Model5)
View(Model1)
total.l.d.s <- diff(total.l.d, 60)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
total.l.d.s <- diff(total.l.d, 72)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
total.l.d.s <- diff(total.l.d, 24) # difference log total seasonal
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 50)
## Looking for seasonal trends
par(mfrow = c(1,3))
tsplot(total.l.d.s)
acf(total.l.d.s, lag.max = 50)
pacf(total.l.d.s, lag.max = 100)
Model5 <- sarima(total.l, 0,1,3, P = 0, D = 1, Q = 2, S = 24)
View(Model5)
View(Model1)
Model1 <- sarima(total.l, 1,1,0, P = 0, D = 1, Q = 1, S = 12) ## BEST
Model5 <- sarima(total.l, 1,1,3, P = 0, D = 1, Q = 2, S = 24)
View(Model5)
View(Model1)
View(Model5)
Model5 <- sarima(total.l, 1,1,2, P = 0, D = 1, Q = 2, S = 24)
View(Model5)
View(Model1)
total.l.d.s <- diff(total.l.d, 12) # difference log total seasonal
