View(Model7)
View(Model3)
resd7 = Model7[["fit"]][["residuals"]]; resd6 = Model6[["fit"]][["residuals"]]; resd3 = Model3[["fit"]][["residuals"]]
Model7[["fit"]][["residuals"]]
?Box.test
Box.test(resd7, lag = 12, type = "Ljung-Box", fitdf = 13)
Model7 <-sarima(total.l, 12, 1, 1)
Box.test(resd7, lag = 14, type = "Ljung-Box", fitdf = 13)
Box.test(resd7, lag = 20, type = "Ljung-Box", fitdf = 13)
Box.test(resd7, lag = 21, type = "Ljung-Box", fitdf = 13)
Box.test(resd7, lag = 22, type = "Ljung-Box", fitdf = 13)
Box.test(resd7, lag = 23, type = "Ljung-Box", fitdf = 13)
Box.test(resd7, lag = 27, type = "Ljung-Box", fitdf = 13)
get_LjungBox_pvalues <- function(resd, max.lag, p, q){
df <- p + q
pv <- c()
for(i in df+1: max.lag){
p <- Box.test(resd, i, type = "Ljung-Box", fitdf = p+q )
pv = append(pv, p)
}
return(pv)
}
LJB_pvalues <- function(resd, max.lag, p, q){
df <- p + q
pv <- c()
for(i in df+1: max.lag){
p <- Box.test(resd, i, type = "Ljung-Box", fitdf = p+q )
pv = append(pv, p)
}
return(pv)
}
tt = LJB_pvalues(resd7, 35, 12, 1)
LJB_pvalues <- function(resd, max.lag, p, q){
df =  (p + q)
pv <- c()
for(i in df+1: max.lag){
p <- Box.test(resd, i, type = "Ljung-Box", fitdf = p+q )
pv = append(pv, p)
}
return(pv)
}
tt = LJB_pvalues(resd7, 35, 12, 1)
LJB_pvalues <- function(resd, max.lag, df){
pv <- c()
for(i in df+1: max.lag){
p <- Box.test(resd, i, type = "Ljung-Box", fitdf = df)
pv = append(pv, p)
}
return(pv)
}
tt = LJB_pvalues(resd7, 35, 12, 1)
tt = LJB_pvalues(resd7, 35, 12)
View(tt)
LJB_pvalues <- function(resd, max.lag, df){
pv <- c()
for(i in df+1: max.lag){
p <- Box.test(resd, i, type = "Ljung-Box", fitdf = df)$pvalue
pv = append(pv, p)
}
return(pv)
}
tt = LJB_pvalues(resd7, 35, 12)
LJB_pvalues <- function(resd, max.lag, df){
pv <- c()
for(i in df+1: max.lag){
p <- Box.test(resd, i, type = "Ljung-Box", fitdf = df)$p.value
pv = append(pv, p)
}
return(pv)
}
tt = LJB_pvalues(resd7, 35, 12)
tt
Model7 <-sarima(total.l, 12, 1, 1)
Model7 <-sarima(total.l, 13, 1, 1)
View(Model7)
Model7 <-sarima(total.l, 12, 1, 1)
Model8 <- sarima(total.l, 13,1,1)
View(Model8)
View(Model7)
View(Model8)
View(Model7)
View(Model8)
View(Model7)
View(Model8)
View(Model7)
View(Model3)
Model3$ttable
Model8$ttable
Model8 <- sarima(total.l, 13,1,2)
View(Model8)
View(Model7)
View(Model8)
View(Model7)
View(Model8)
Model8$ttable
Model8 <- sarima(total.l, 13,1,3)
View(Model8)
View(Model7)
View(Model8)
LJB_pvalues <- function(resd, max.lag, df){
pv <- c()
for(i in df+1: max.lag){
p <- Box.test(resd, i, type = "Ljung-Box", fitdf = df)$p.value
pv = append(pv, p)
}
return(pv)
}
tt = LJB_pvalues(resd7, 35, 13)
Model7 <-sarima(total.l, 12, 1, 1)
tt
LJB_pvalues <- function(Model, max.lag, df){
resd = Model[["fit"]][["residuals"]]
pv <- c()
for(i in df+1: max.lag){
p <- Box.test(resd, i, type = "Ljung-Box", fitdf = df)$p.value
pv = append(pv, p)
}
return(pv)
}
View(Model7)
tt = LJB_pvalues(Model7, 35, 13)
tt
p7  = LJB_pvalues(Model7, 35, 13); p6 = LJB_pvalues(Model6, 35, 14); p3 = LJB_pvalues(Model3, 35, 11)
Model3 <- sarima(total.l, 11,1,0)
p3
p6
rm(tt)
rm(resd3, resd6, resd7)
?arima
fc1 <- forecast(Model1, h = 36)
Model1 <-arima(total.l, 12,1,1)
Model1 <-arima(total.l, c(12,1,1))
fc1 <- forecast(Model1, h = 36)
View(fc1)
View(fc1)
fc1[["mean"]]
Model1 <-arima(total.l, c(12,1,1))
fc1 <- predict(Model1, n.ahead = 10)
View(fc1)
fc1[["pred"]]
rm(f1)
rm(fc1)
?tsplot
ts.plot(total.l, fore1$pred, xlim = c(1972, 2025))
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 20)
ts.plot(total.l, fore1$pred, xlim = c(1972, 2025))
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 20)
ts.plot(total.l, fore1$pred, xlim = c(1972, 2025), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="p", col=2)
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 20)
ts.plot(total.l, fore1$pred, xlim = c(1972, 2025), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 20)
ts.plot(total.l, xlim = c(1972, 2025), ylab = "Price Change")
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 20)
ts.plot(total.l, xlim = c(1972, 2025), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 20)
ts.plot(log(total), xlim = c(1972, 2025), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
## Forecasting
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 36)
ts.plot(log(total), xlim = c(1972, 2025), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 36)
ts.plot(log(total), xlim = c(1972, 2024), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
total.f <- window(total, end = 2023)
Model1 <-arima(total.f, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 24)
ts.plot(log(total), xlim = c(1972, 2024), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
## Forecasting
total.f <- window(total, end = 2023)
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 24)
ts.plot(log(total.f), xlim = c(1972, 2024), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
total.f <- window(total, end = 2022)
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 24)
ts.plot(log(total.f), xlim = c(1972, 2023), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
library(astsa)
library(ggplot2)
library(timeSeries)
library(forecast)
M.BCPI <- as.data.frame(read.csv("M.BCPI.csv"))
total <- ts(M.BCPI[,3], start = 1972, frequency = 12)
tsplot(total)
# total.c <-  window(total, end = 2020)  # Look at Pre-Covid levels
total.l <- log(total) # log total
total.l.d <- diff(total.l, 1) # difference log total
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
### USE Model$ttable to look at significant coefficients
# NOTE: Starting from a lower p, q value dont pass Ljung -Box test
M1 <- sarima(total.l, 0,1,12)
M2 <- sarima(total.l, 12,1,0)
M3 <- sarima(total.l, 11,1,0)
M4 <- sarima(total.l, 11,1,1)
M5 <- sarima(total.l, 11,1,2)
M6 <- sarima(total.l, 12,1,2)
M7 <-sarima(total.l, 12, 1, 1) # 13,1,1 is similar
# Winner Model 7,6,3
AICv <- c(Model1$AIC, Model2$AIC, Model3$AIC, Model4$AIC, Model5$AIC, Model6$AIC, Model7$AIC, Model8$AIC)
### USE Model$ttable to look at significant coefficients
# NOTE: Starting from a lower p, q value dont pass Ljung -Box test
M1 <- sarima(total.l, 0,1,12)
M2 <- sarima(total.l, 12,1,0)
M3 <- sarima(total.l, 11,1,0)
M4 <- sarima(total.l, 11,1,1)
M5 <- sarima(total.l, 11,1,2)
M6 <- sarima(total.l, 12,1,2)
M7 <-sarima(total.l, 12, 1, 1) # 13,1,1 is similar
# Winner Model 7,6,3
AICv <- c(M1$AIC, M2$AIC, M3$AIC, M4$AIC, M5$AIC, M6$AIC, M7$AIC, M8$AIC)
AICv <- c(M1$AIC, M2$AIC, M3$AIC, M4$AIC, M5$AIC, M6$AIC, M7$AIC)
BestAIC <- order(AICv)[1:3]
BestAIC <- order(AICv)[1:4] # Returns three best models with AIC criterion
# Extracts Ljung - Box statistic p -values for an ARMA(p,d,q)
# NOTE: df = p + q
LJB_pvalues <- function(Model, max.lag, df){
resd = Model[["fit"]][["residuals"]]
pv <- c()
for(i in df+1: max.lag){
p <- Box.test(resd, i, type = "Ljung-Box", fitdf = df)$p.value
pv = append(pv, p)
}
return(pv)
}
p7  = LJB_pvalues(M7, 35, 13); p6 = LJB_pvalues(M6, 35, 14); p1 = LJB_pvalues(M1, 35, 11)
p7
p6
p1
p5 = LJB_pvalues(M5, 35, 14)
p5
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 10)
ts.plot(log(total.f), xlim = c(1972, 2025), ylab = "Price Change")
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 10)
ts.plot(log(total), xlim = c(1972, 2025), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 10)
ts.plot(log(total), xlim = c(1972, 2026), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 10)
ts.plot(log(total), xlim = c(1972, 2028), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
?ts.plot
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 24)
ts.plot(log(total), xlim = c(1972, 2026), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 24)
ts.plot(log(total), xlim = c(1972, 2026), ylab = "Price Change")
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
?ts.plot
View(Model1)
View(fore1)
getwd()
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
library(astsa)
library(ggplot2)
library(timeSeries)
library(forecast)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
Model1 <-arima(total.l, c(12,1,1))
fore1 <- predict(Model1, n.ahead = 24)
ts.plot(log(total), xlim = c(1972, 2026), ylab = "Price Change") # IS IT PRICE CHANGE
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2) # MAYBE ADD A SECOND ERROR BAR
load("~/Desktop/Stat 469/Assignment3/KfoldDatasplit.RData")
View(ErrorMat)
View(MS.ErrorMat)
?boxplot
boxplot(ErrorMat)
boxplot(ErrorMat[1:3])
library(astsa)
library(ggplot2)
library(timeSeries)
library(forecast)
getwd()
M.BCPI <- as.data.frame(read.csv("M.BCPI.csv"))
total <- ts(M.BCPI[,3], start = 1972, frequency = 12)
tsplot(total)
# total.c <-  window(total, end = 2020)  # Look at Pre-Covid levels
total.l <- log(total) # log total
total.l.d <- diff(total.l, 1) # difference log total
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
M7 <-sarima(total.l, 12, 1, 1)
M7$ttable
M8 <-sarima(total.l, 12,0,0)
View(M8)
View(M7)
View(M8)
M6 <- sarima(total.l, 12,1,2)
M1 <- sarima(total.l, 0,1,12)
M1$ttable
M5 <- sarima(total.l, 11,1,2)
M5$ttable
M7 <-sarima(total.l, 12, 1, 1)
M7$ttable
M8 <-sarima(total.l, 12,0,0)
M5 <- sarima(total.l, 11,1,2)
M5$ttable
Model1 <-arima(total.l, c(11,1,2))
fore1 <- predict(Model1, n.ahead = 24)
ts.plot(log(total), xlim = c(1972, 2026), ylab = "Price Change") # IS IT PRICE CHANGE
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2) # MAYBE ADD A SECOND ERROR BAR
Model1 <-arima(total.l, c(0,1,12))
fore1 <- predict(Model1, n.ahead = 24)
ts.plot(log(total), xlim = c(1972, 2026), ylab = "Price Change") # IS IT PRICE CHANGE
U =fore1$pred + fore1$se
L = fore1$pred - fore1$se
xx = c(time(U), rev(time(U))); yy = c(L, rev(U))
polygon(xx, yy, border = 8, col = gray(.6, alpha = .2))
lines(fore1$pred, type="l", col=2)
M5$ttable
M6 <- sarima(total.l, 12,1,3)
View(M6)
View(M5)
View(M6)
View(M1)
M6$ttable
M6 <- sarima(total.l, 12,1,2)
M5$ttable
M5 <- sarima(total.l, 11,1,2)
M5$ttable
M4 <- sarima(total.l, 11,1,3)
View(M4)
View(M5)
View(M4)
View(M5)
View(M4)
View(M5)
M4$ttable
M1$ttable
M2 <- sarima(total.l, 1,1,12)
View(M2)
View(M1)
View(M2)
M2 <- sarima(total.l, 1,1,11)
M2$ttable
M1$ttable
M2 <- sarima(total.l, 0,1,11)
M2 <- sarima(total.l, 2,1,12)
View(M2)
View(M1)
View(M2)
M2$ttable
M2 <- sarima(total.l, 2,1,11)
View(M2)
View(M1)
View(M2)
View(M5)
View(M1)
View(M5)
M5 <- sarima(total.l, 11,1,2)
M8 <-sarima(total.l, 12,1,2)
M7 <-sarima(total.l, 12, 1, 1)
M7$ttable
M7 <-sarima(total.l, 12, 1, 0)
M7$ttable
M8 <-sarima(total.l, 11,1,0)
M8$ttable
View(M8)
View(M1)
View(M8)
View(M1)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
total <- ts(M.BCPI[,3], start = 1972, frequency = 12)
tsplot(total)
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
M1 <- sarima(total.l, 0,1,12)
source("~/Desktop/Time-Series/Time-Series-Project/TimeSeriesFinal.R", echo=TRUE)
M7 <-sarima(total.l, 12, 1, 1)
M7$ttable
M8 <-sarima(total.l, 12,1,0)
M8$ttable
M8 <-sarima(total.l, 11,1,0)
M8$ttable
tsplot(total.l)#
## Plotting log ting
par(mfrow = c(1,3))
tsplot(total.l.d)
acf(total.l.d)
pacf(total.l.d)
M9 <-sarima(total.l, 2,1,0, 2,0,0, 12)
M9 <-sarima(total.l, 2,1,0, 0,0,1, 12)
M9 <-sarima(total.l, 2,1,0, 0,0,2, 12)
M8 <-sarima(total.l, 12,1,0)
M8$ttable
M1 <- sarima(total.l, 0,1,12)
M1$ttable
M1$ttable
M5 <- sarima(total.l, 11,1,2)
M5$ttable
View(M5)
View(M1)
total <- ts(M.BCPI[,3], start = 1972, frequency = 12)
tsplot(total)
M9 <-sarima(total.l, 0,1,0, 0,0,1, 12)
M9 <-sarima(total.l, 1,1,0, 0,0,1, 12)
M9 <-sarima(total.l, 12,1,0, 0,0,1, 12)
View(M9)
View(M1)
M9$ttable
M9 <-sarima(total.l, 12,1,0, 0,0,2, 12)
View(M9)
M9 <-sarima(total.l, 0,1,12, 0,0,2, 12)
