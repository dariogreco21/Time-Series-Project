library(astsa)
library(ggplot2)
library(timeSeries)
setwd("/Users/dario/Desktop/TSP") # Set your working directory
library(astsa)
library(ggplot2)
library(timeSeries)
# col, name, detail
# 2, BCPI,	 BCPI Total
# 3, BCNE,	 BCPI Excluding Energy
# 4, ENER,	 BCPI Energy
# 5, MTLS,	 BCPI Metals and Minerals
# 6, FOPR,	 BCPI Forestry
# 7, AGRI,	 BCPI Agriculture
# 8, FISH,	 BCPI Fish
## A.____ = annual metric; M.____ = monthly metric
## 1972-01-01 - 2023-10-01 ##
M.BCPI <- as.data.frame(read.csv("M.BCPI.csv"))
M.ER <- as.data.frame(read.csv("ER.csv"))
M.BCPI <- as.data.frame(read.csv("M.BCPI.csv"))
View(M.BCPI)
total <- ts(M.BCPI[,2], start = 1972, frequency = 12)
tsplot(total)
price <- window(total, start = 1996)
tsplot(price)
price.tran <- diff((log(y)), 1)
price.tran <- diff((log(y)), 1)
price.tran <- diff((log(price)), 1)
par(mfrow = c(1,3))
tsplot(price.tran, ylab = "BCPI", main = "BCPI 1996-2023")
acf(price.tran)
pacf(price.tran)
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
# Look at log transformation
price.log <- log(price)
tsplot(price.log, main = "Log Price of Index")
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
lines(pirce.log, col = "red")
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
line(pirce.log, col = "red")
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
line(pirce.log)
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
price.log <- log(price)
line(pirce.log)
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
line(price.log, col = "red")
par(mfrow=c(1,2))
# Use post 1996 prices (crude oil price index changed)
price <- window(total, start = 1996)
tsplot(price, main = "Tota; Index")
line(price.log)
# Look at log transformation
price.log <- log(price)
tsplot(price.log, main = "Log Price of Index")
getwd()
# Need to find transformation for stationary distribution
price.tran <- diff((price), 1)
par(mfrow = c(1,3))
tsplot(price.tran, ylab = "BCPI", main = "BCPI 1996-2023")
acf(price.tran)
pacf(price.tran)
# Need to find transformation for stationary distribution
price.tran <- diff((price.log), 1)
par(mfrow = c(1,3))
tsplot(price.tran, ylab = "BCPI", main = "BCPI 1996-2023")
acf(price.tran)
pacf(price.tran)
# Need to find transformation for stationary distribution
price.tran <- diff((price), 1)
par(mfrow = c(1,3))
tsplot(price.tran, ylab = "BCPI", main = "BCPI 1996-2023")
acf(price.tran)
pacf(price.tran)
Model2 <- arima(price.log,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model2 <- sarima(price.log,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model3 <-sarima(price.log,0,1,2,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model4 <- sarima(price.log,0,1,3,details = TRUE, no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model5 <-sarima(price.log,1,1,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model6<- sarima(price.log,1,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model7<- sarima(price.log,2,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
AICr1 <- c(Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC,Model7$AIC)
?which.min
rm(Model7)
Model1 <- sarima(price.log,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model2 <-sarima(price.log,0,1,2,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model3 <- sarima(price.log,0,1,3,details = TRUE, no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model4 <-sarima(price.log,1,1,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model5<- sarima(price.log,1,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model6<- sarima(price.log,2,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
AICr1 <- c(Model1$AIC,Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC)
best <- which.min(AICr1)
best
AICr1
Model1 <- sarima(price.log,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model1 <- sarima(price.log,0,2,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model2 <-sarima(price.log,0,2,2,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model3 <- sarima(price.log,0,2,3,details = TRUE, no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model4 <-sarima(price.log,1,2,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model5<- sarima(price.log,1,2,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model6<- sarima(price.log,2,2,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
AICr1 <- c(Model1$AIC,Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC)
best2 <- which.min(AICr1)
Model4 <-sarima(price.log,1,2,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
?window
price
price
price.log.cov = window(price.log, end = 2019)
tail(price.log.cov)
View(M.BCPI)
price.log.cov = window(price.log, end = 2019-02-01)
price.log.cov = window(price.log, end = 2019)
price.log.cov = window(price.log, end = 2019)
Model1 <- sarima(price.log.cov,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model2 <-sarima(price.log.cov,0,1,2,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model3 <- sarima(price.log.cov,0,1,3,details = TRUE, no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model4 <-sarima(price.log.cov,1,1,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model5<- sarima(price.log.cov,1,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model6<- sarima(price.log.cov,2,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
AICr1 <- c(Model1$AIC,Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC)
best <- which.min(AICr1)
AICr1 <- c(Model1$AIC,Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC)
AICr1
Model4 <-sarima(price.log.cov,1,1,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
View(Model4)
price.log.cov
price.log.cov = window(price.log, end = 2020)
price.log.cov = window(price.log, end = 2020)
price.log.cov
Model1 <- sarima(price.log.cov,0,1,1,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model2 <-sarima(price.log.cov,0,1,2,details = TRUE,  no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model3 <- sarima(price.log.cov,0,1,3,details = TRUE, no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model4 <-sarima(price.log.cov,1,1,1,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model5<- sarima(price.log.cov,1,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
Model6<- sarima(price.log.cov,2,1,2,details = TRUE,   no.constant = TRUE, tol = sqrt(.Machine$double.eps))
AICr1 <- c(Model1$AIC,Model2$AIC,Model3$AIC,Model4$AIC,Model5$AIC,Model6$AIC)
# best model
best <- which.min(AICr1) # model 4 is the best
